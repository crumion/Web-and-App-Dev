{"version":3,"file":"index.modern.js","sources":["../src/lib/fetchScores.ts","../src/index.tsx"],"sourcesContent":["const cheerio = require('cheerio')\n\nexport async function fetchScores(sport: 'mlb' | 'nba' | 'nfl') {\n  const url = `https://www.espn.com/${sport}/scoreboard`\n  const website = await fetch(url)\n    .then((res: any) => res.text())\n    .then((body: any) => body)\n\n  const $ = cheerio.load(website)\n  const scripts = await $('script').toArray()\n\n  const scoreboardScript = scripts.find(\n    (script: any) =>\n      script.children[0] &&\n      script.children[0].data.includes('window.espn.scoreboardData')\n  ).children[0].data\n\n  const strippedData = scoreboardScript\n    .replace('window.espn.scoreboardData', '')\n    .replace('=', '')\n    .replace(\n      'if(!window.espn_ui.device.isMobile){window.espn.loadType = \"ready\"};',\n      ''\n    )\n    .replace(/;/g, '')\n    .split('window.espn.scoreboardSettings')[0]\n    .trim()\n\n  const data = JSON.parse(strippedData)\n\n  const { events } = data\n\n  let scores: any[] = []\n  events.map((event: any) => {\n    const { competitions, date, shortName, status } = event\n\n    const home = competitions[0].competitors.find(\n      (team: any) => team.homeAway === 'home'\n    )\n    const away = competitions[0].competitors.find(\n      (team: any) => team.homeAway === 'away'\n    )\n    const situation = competitions[0].situation\n\n    delete home.team.links\n    delete home.team.uid\n    delete home.team.id\n    delete away.team.links\n    delete away.team.uid\n    delete away.team.id\n\n    scores = [\n      ...scores,\n      {\n        startTime: date,\n        shortName,\n        status: {\n          inning: status.period,\n          state: status.type.state,\n          detail: status.type.detail,\n          shortDetail: status.type.shortDetail,\n          completed: status.type.completed\n        },\n        situation,\n        teams: {\n          awayTeam: {\n            ...away.team,\n            score: away.score\n          },\n          homeTeam: {\n            ...home.team,\n            score: home.score\n          }\n        }\n      }\n    ]\n  })\n\n  return scores\n}\n","import { useEffect, useState } from 'react'\nimport { fetchScores } from './lib/fetchScores'\n\ninterface Options {\n  updateIntervalSeconds?: number\n}\n\ntype Sport = 'mlb' | 'nba' | 'nfl'\n\nexport const useScores = (sport: Sport, options?: Options) => {\n  const updateIntervalSeconds = options?.updateIntervalSeconds || 30\n  const [scores, setScores] = useState([])\n\n  useEffect(() => {\n    const getSport = async () => {\n      const sportsScores: any = await fetchScores(sport)\n      setScores(sportsScores)\n    }\n\n    getSport()\n\n    const refreshInterval = setInterval(getSport, 1000 * updateIntervalSeconds)\n\n    return () => {\n      clearInterval(refreshInterval)\n    }\n  }, [sport])\n\n  return {\n    scores\n  }\n}\n"],"names":["fetchScores","sport","url","fetch","then","res","text","body","website","$","cheerio","load","toArray","scripts","scoreboardScript","find","script","children","data","includes","strippedData","replace","split","trim","JSON","parse","events","scores","map","event","competitions","date","shortName","status","home","competitors","team","homeAway","away","situation","links","uid","id","startTime","inning","period","state","type","detail","shortDetail","completed","teams","awayTeam","score","homeTeam","require","useScores","options","updateIntervalSeconds","useState","setScores","useEffect","getSport","sportsScores","refreshInterval","setInterval","clearInterval"],"mappings":"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"}